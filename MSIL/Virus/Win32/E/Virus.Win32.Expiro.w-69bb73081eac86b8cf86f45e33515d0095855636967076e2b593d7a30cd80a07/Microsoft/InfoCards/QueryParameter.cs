// Decompiled with JetBrains decompiler
// Type: Microsoft.InfoCards.QueryParameter
// Assembly: infocard, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
// MVID: 516D8B44-4448-4D2C-8B8E-FFBB3FFE472B
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Virus.Win32.Expiro.w-69bb73081eac86b8cf86f45e33515d0095855636967076e2b593d7a30cd80a07.exe

using Microsoft.InfoCards.Diagnostics;
using System.Collections.Generic;

namespace Microsoft.InfoCards
{
  internal class QueryParameter
  {
    private string m_indexName;
    private List<IndexObject> m_objects;

    public QueryParameter(string name)
    {
      this.m_indexName = !string.IsNullOrEmpty(name) ? name : throw InfoCardTrace.ThrowHelperArgumentNull(nameof (name));
      this.m_objects = new List<IndexObject>();
    }

    public QueryParameter(string name, params object[] values)
      : this(name)
    {
      for (int index = 0; index < values.Length; ++index)
        this.AddMatch(values[index]);
    }

    public string IndexName
    {
      get => this.m_indexName;
      internal set => this.m_indexName = value;
    }

    internal IndexObject this[int index] => this.m_objects[index];

    public int Count => this.m_objects.Count;

    public void Clear() => this.m_objects.Clear();

    public void AddCompiled(byte[] compiledForm) => this.m_objects.Add(new IndexObject(compiledForm));

    public void AddMatch(params object[] values)
    {
      if (values == null || values.Length == 0)
        throw InfoCardTrace.ThrowHelperArgumentNull(nameof (values));
      this.m_objects.Add(new IndexObject(values));
    }
  }
}
