// Decompiled with JetBrains decompiler
// Type: Microsoft.InfoCards.QueryParameter
// Assembly: infocard, Version=3.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
// MVID: ADE0A079-11DB-4A46-8BDE-D2A592CA8DEA
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Virus.Win32.Expiro.w-1f15ee7e9f7da02b6bfb4c5a5e6484eb9fa71b82d3699c54bcc7a31794b4a66d.exe

using Microsoft.InfoCards.Diagnostics;
using System.Collections.Generic;

namespace Microsoft.InfoCards
{
  internal class QueryParameter
  {
    private string m_indexName;
    private List<IndexObject> m_objects;

    public QueryParameter(string name)
    {
      this.m_indexName = !string.IsNullOrEmpty(name) ? name : throw InfoCardTrace.ThrowHelperArgumentNull(nameof (name));
      this.m_objects = new List<IndexObject>();
    }

    public QueryParameter(string name, params object[] values)
      : this(name)
    {
      for (int index = 0; index < values.Length; ++index)
        this.AddMatch(values[index]);
    }

    public string IndexName
    {
      get => this.m_indexName;
      internal set => this.m_indexName = value;
    }

    internal IndexObject this[int index] => this.m_objects[index];

    public int Count => this.m_objects.Count;

    public void Clear() => this.m_objects.Clear();

    public void AddCompiled(byte[] compiledForm) => this.m_objects.Add(new IndexObject(compiledForm));

    public void AddMatch(params object[] values)
    {
      if (values == null || values.Length == 0)
        throw InfoCardTrace.ThrowHelperArgumentNull(nameof (values));
      this.m_objects.Add(new IndexObject(values));
    }
  }
}
