// Decompiled with JetBrains decompiler
// Type: TaskScheduler.MonthlyDOWTrigger
// Assembly: AutoKMS, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: D1CED9E3-1FC7-49B8-B3AC-44976AB7F6E4
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\HackTool.Win32.KMSAuto.i-f317ba4d4051fad64a0aa45b587fa3dcea795bac30acec2872779abe31a07cbe.exe

using TaskSchedulerInterop;

namespace TaskScheduler
{
  public class MonthlyDOWTrigger : StartableTrigger
  {
    public MonthlyDOWTrigger(
      short hour,
      short minutes,
      DaysOfTheWeek daysOfTheWeek,
      WhichWeek whichWeeks,
      MonthsOfTheYear months)
    {
      this.SetStartTime((ushort) hour, (ushort) minutes);
      this.taskTrigger.Type = TaskTriggerType.TIME_TRIGGER_MONTHLYDOW;
      this.taskTrigger.Data.monthlyDOW.WhichWeek = (ushort) whichWeeks;
      this.taskTrigger.Data.monthlyDOW.DaysOfTheWeek = (ushort) daysOfTheWeek;
      this.taskTrigger.Data.monthlyDOW.Months = (ushort) months;
    }

    public MonthlyDOWTrigger(
      short hour,
      short minutes,
      DaysOfTheWeek daysOfTheWeek,
      WhichWeek whichWeeks)
      : this(hour, minutes, daysOfTheWeek, whichWeeks, MonthsOfTheYear.January | MonthsOfTheYear.February | MonthsOfTheYear.March | MonthsOfTheYear.April | MonthsOfTheYear.May | MonthsOfTheYear.June | MonthsOfTheYear.July | MonthsOfTheYear.August | MonthsOfTheYear.September | MonthsOfTheYear.October | MonthsOfTheYear.November | MonthsOfTheYear.December)
    {
    }

    internal MonthlyDOWTrigger(ITaskTrigger iTrigger)
      : base(iTrigger)
    {
    }

    public short WhichWeeks
    {
      get => (short) this.taskTrigger.Data.monthlyDOW.WhichWeek;
      set
      {
        this.taskTrigger.Data.monthlyDOW.WhichWeek = (ushort) value;
        this.SyncTrigger();
      }
    }

    public DaysOfTheWeek WeekDays
    {
      get => (DaysOfTheWeek) this.taskTrigger.Data.monthlyDOW.DaysOfTheWeek;
      set
      {
        this.taskTrigger.Data.monthlyDOW.DaysOfTheWeek = (ushort) value;
        this.SyncTrigger();
      }
    }

    public MonthsOfTheYear Months
    {
      get => (MonthsOfTheYear) this.taskTrigger.Data.monthlyDOW.Months;
      set
      {
        this.taskTrigger.Data.monthlyDOW.Months = (ushort) value;
        this.SyncTrigger();
      }
    }
  }
}
