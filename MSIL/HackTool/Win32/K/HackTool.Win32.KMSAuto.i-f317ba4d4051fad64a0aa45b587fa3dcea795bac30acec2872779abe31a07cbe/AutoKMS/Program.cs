// Decompiled with JetBrains decompiler
// Type: AutoKMS.Program
// Assembly: AutoKMS, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: D1CED9E3-1FC7-49B8-B3AC-44976AB7F6E4
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\HackTool.Win32.KMSAuto.i-f317ba4d4051fad64a0aa45b587fa3dcea795bac30acec2872779abe31a07cbe.exe

using Office_2010_Toolkit;
using Office_2010_Toolkit.Configuration;
using Office_2010_Toolkit.Logic;
using System;
using System.IO;
using System.ServiceProcess;
using System.Windows.Forms;

namespace AutoKMS
{
  internal static class Program
  {
    [STAThread]
    private static void Main()
    {
      Common.OfficeCriticalVariablesCheck();
      Directory.SetCurrentDirectory(Path.GetDirectoryName(Application.ExecutablePath));
      Settings.GetSettingsAutoKMS();
      string[] commandLineArgs = Environment.GetCommandLineArgs();
      if (commandLineArgs.Length > 1)
      {
        if (!commandLineArgs[1].Equals("/Application", StringComparison.CurrentCultureIgnoreCase))
          return;
        new AutoKMS.AutoKMS().RunAutoKMS();
      }
      else
      {
        if (!Common.IsAutoKMSServiceInstalled())
          Activation.MakeAutoKMSService(Environment.CurrentDirectory);
        ServiceBase.Run(new ServiceBase[1]
        {
          (ServiceBase) new AutoKMSService()
        });
      }
    }
  }
}
