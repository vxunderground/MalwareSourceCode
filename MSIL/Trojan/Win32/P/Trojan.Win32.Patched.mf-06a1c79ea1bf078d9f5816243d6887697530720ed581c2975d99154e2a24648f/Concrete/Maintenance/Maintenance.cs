// Decompiled with JetBrains decompiler
// Type: VMS.OSService.Concrete.Maintenance.Maintenance
// Assembly: VMS.OSP.Service, Version=1.4.2.0, Culture=neutral, PublicKeyToken=null
// MVID: 7B29B897-26BF-407B-B0D0-14253383A174
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.Win32.Patched.mf-06a1c79ea1bf078d9f5816243d6887697530720ed581c2975d99154e2a24648f.exe

using System;
using VMS.OSP.Services.Logging;
using VMS.OSP.Services.Maintenance;
using VMS.OSService.Abstract;

namespace VMS.OSService.Concrete.Maintenance
{
  public class Maintenance : AbstractService
  {
    private const string cSysLogCategory = "MaintenanceComponent";

    internal override void OnCustomEvent(int command)
    {
      if (command != 150)
        return;
      try
      {
        this.WriteSysLog((OSP_SEVERITY) 6, "MaintenanceComponent", "Executing Maintenance");
        MaintenanceSvc.Instance.ManuallyStartAll();
      }
      catch (Exception ex)
      {
        this.WriteSysLog((OSP_SEVERITY) 6, "MaintenanceComponent", "Maintenance comp error: \r\n" + ex.ToString());
      }
    }

    internal override void OnStart(string[] args)
    {
      try
      {
        this.WriteSysLog((OSP_SEVERITY) 6, "MaintenanceComponent", "Starting Maintenance Component");
        MaintenanceSvc.Instance.StartAsync();
      }
      catch (Exception ex)
      {
        this.WriteSysLog((OSP_SEVERITY) 3, "MaintenanceComponent", ex.Message);
      }
    }

    internal override void OnStop()
    {
      try
      {
        this.WriteSysLog((OSP_SEVERITY) 6, "MaintenanceComponent", "Stopping Maintenance Component");
        MaintenanceSvc.Instance.Stop();
      }
      catch (Exception ex)
      {
        this.WriteSysLog((OSP_SEVERITY) 3, "MaintenanceComponent", ex.Message);
      }
    }
  }
}
