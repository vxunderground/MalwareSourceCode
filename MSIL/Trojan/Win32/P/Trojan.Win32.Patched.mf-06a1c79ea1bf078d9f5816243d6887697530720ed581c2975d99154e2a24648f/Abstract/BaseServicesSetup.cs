// Decompiled with JetBrains decompiler
// Type: VMS.OSService.Abstract.BaseServicesSetup
// Assembly: VMS.OSP.Service, Version=1.4.2.0, Culture=neutral, PublicKeyToken=null
// MVID: 7B29B897-26BF-407B-B0D0-14253383A174
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.Win32.Patched.mf-06a1c79ea1bf078d9f5816243d6887697530720ed581c2975d99154e2a24648f.exe

using System;
using System.Collections;
using System.Configuration;
using System.Diagnostics;
using VMS.OSP.Services.Logging;

namespace VMS.OSService.Abstract
{
  public abstract class BaseServicesSetup
  {
    private ArrayList _concreteServices = new ArrayList();
    private SysLog _sysLog;
    private EventLog _evtLog;

    public BaseServicesSetup(EventLog evtLog)
    {
      this._evtLog = evtLog;
      this.OpenSysLog();
    }

    private void OpenSysLog()
    {
      this._sysLog = new SysLog();
      this._sysLog.OpenLog();
    }

    protected bool ServiceComponentEnabled(string componentName)
    {
      bool flag = true;
      try
      {
        flag = (bool) new AppSettingsReader().GetValue(componentName, typeof (bool));
      }
      catch (Exception ex)
      {
      }
      return flag;
    }

    protected void AddService(AbstractService aNewService)
    {
      aNewService.Init(this._sysLog, this._evtLog);
      this._concreteServices.Add((object) aNewService);
    }

    public void StartAll(string[] args)
    {
      foreach (AbstractService concreteService in this._concreteServices)
        concreteService.OnStart(args);
    }

    public void StopAll()
    {
      foreach (AbstractService concreteService in this._concreteServices)
        concreteService.OnStop();
    }

    public void CustomCommandToAll(int cmd)
    {
      foreach (AbstractService concreteService in this._concreteServices)
        concreteService.OnCustomEvent(cmd);
    }
  }
}
