// Decompiled with JetBrains decompiler
// Type: Bmc.Broker.TicketState
// Assembly: updateservice, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: A6A1FC23-14F7-4CCE-B702-0F9FFD2CD5AC
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.Win32.Patched.mf-9c4f7eb57e580673b883e57f31931bcbce8bd5d8de1a509a25b8b5a175335d9f.exe

using Net.LShift.SPKI;
using System;
using System.Collections;

namespace Bmc.Broker
{
  public class TicketState
  {
    private IDictionary PackageStates;

    public TicketState(IDictionary states) => this.PackageStates = states;

    public PackageState GetPackageState(string package) => (PackageState) this.PackageStates[(object) package];

    public bool HasPermission(string product, string perm)
    {
      foreach (PackageState packageState in (IEnumerable) this.PackageStates.Values)
      {
        if (packageState.HasPermission(product, perm))
          return true;
      }
      return false;
    }

    public string GetProperty(string productName, string propName)
    {
      foreach (PackageState packageState in (IEnumerable) this.PackageStates.Values)
      {
        string property = packageState.GetProperty(productName, propName);
        if (property != null)
          return property;
      }
      return (string) null;
    }

    public DateTime GetDateProperty(string productName, string propName) => DateTimeFormatter.ToDateTime(this.GetProperty(productName, propName));
  }
}
