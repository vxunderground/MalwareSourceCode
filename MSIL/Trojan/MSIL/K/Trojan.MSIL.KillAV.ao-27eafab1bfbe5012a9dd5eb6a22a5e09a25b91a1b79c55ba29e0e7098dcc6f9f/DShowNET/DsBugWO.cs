// Decompiled with JetBrains decompiler
// Type: DShowNET.DsBugWO
// Assembly: p, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
// MVID: 91D63E37-42E0-404C-97F4-07116ACD2D57
// Assembly location: C:\Users\Administrateur\Downloads\Virusshare-00000-msil\Trojan.MSIL.KillAV.ao-27eafab1bfbe5012a9dd5eb6a22a5e09a25b91a1b79c55ba29e0e7098dcc6f9f.exe

using System;
using System.Runtime.InteropServices;
using System.Runtime.Remoting.Services;

namespace DShowNET
{
  public class DsBugWO
  {
    public static object CreateDsInstance(ref Guid clsid, ref Guid riid)
    {
      IntPtr ptrIf;
      int instance = DsBugWO.CoCreateInstance(ref clsid, IntPtr.Zero, CLSCTX.Inproc, ref riid, out ptrIf);
      if (instance != 0 || ptrIf == IntPtr.Zero)
        Marshal.ThrowExceptionForHR(instance);
      Guid iid = new Guid("00000000-0000-0000-C000-000000000046");
      Marshal.QueryInterface(ptrIf, ref iid, out IntPtr _);
      object dsInstance = EnterpriseServicesHelper.WrapIUnknownWithComObject(ptrIf);
      Marshal.Release(ptrIf);
      return dsInstance;
    }

    [DllImport("ole32.dll")]
    private static extern int CoCreateInstance(
      ref Guid clsid,
      IntPtr pUnkOuter,
      CLSCTX dwClsContext,
      ref Guid iid,
      out IntPtr ptrIf);
  }
}
